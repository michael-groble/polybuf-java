/*
 * Copyright (c) 2012 Michael Groble
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
 * documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the
 * Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 * WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS
 * OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
 * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

package polybuf.classifiers;

class PlainTextModel extends BigramTextModel implements ByteArrayModel {

  private static final float[] unigram;
  private static final float[] start;
  private static final float[] end;
  private static final float[][] bigram;
  private static final float log2ProbPad;

  static {
    unigram = new float[] { 31572, 21825, 20242, 16848, 17402, 11832, 14901, 13939, 15875, 6086, 20493, 15617, 25924,
        15635, 11651, 24011, 2055, 17170, 34457, 20065, 7371, 10968, 7178, 2410, 2325, 4844, 995604, 118404, 147589,
        249542, 785374, 74845, 199987, 158927, 740075, 79503, 238221, 356891, 243413, 604170, 481526, 169164, 35403,
        532707, 463673, 485396, 327248, 111275, 50275, 15114, 88748, 80616, 8745, 8182, 7208, 4813, 4480, 4289, 3735,
        3391, 3792, 3910, 1, 1 };
    log2Normalize(unigram);

    start = new float[] { 22723, 19566, 15818, 13657, 11378, 10193, 12807, 12038, 9634, 5485, 18248, 11888, 22457,
        11227, 7139, 20701, 1794, 12592, 28818, 15811, 4914, 9184, 6258, 1216, 1593, 4131, 48825, 29457, 23984, 35253,
        25643, 19887, 22484, 20235, 29083, 6135, 40021, 18420, 39368, 26283, 20385, 55875, 4816, 24892, 54593, 33623,
        14629, 21541, 10034, 2393, 3444, 10251, 1083, 3304, 2208, 1176, 891, 756, 711, 581, 538, 530, 2, 2 };
    log2Normalize(start);

    end = new float[] { 2265, 632, 1155, 841, 1240, 545, 603, 474, 1303, 168, 651, 826, 856, 1054, 1060, 890, 97, 967,
        1831, 1092, 456, 538, 222, 305, 272, 249, 139460, 2759, 4285, 26071, 106260, 3001, 26855, 16138, 78306, 8066,
        27770, 20481, 32245, 97822, 60408, 5436, 6533, 47548, 90526, 69357, 30763, 3944, 1725, 1615, 18856, 5428, 2452,
        1441, 1403, 1194, 1231, 1042, 985, 866, 889, 849, 2, 2 };
    log2Normalize(end);

    bigram = new float[64][];
    bigram[0] = new float[] { 253, 358, 463, 429, 253, 197, 301, 364, 325, 157, 328, 529, 660, 538, 95, 444, 21, 699,
        593, 624, 117, 205, 182, 25, 112, 123, 18, 7, 24, 25, 20, 1, 3, 5, 8, 3, 8, 27, 10, 25, 17, 4, 1, 17, 17, 8, 4,
        3, 2, 3, 7, 9, 15, 21, 18, 15, 24, 13, 12, 16, 15, 9, 1, 1 };
    bigram[1] = new float[] { 253, 90, 89, 78, 117, 30, 63, 51, 125, 17, 64, 71, 147, 69, 96, 69, 4, 73, 108, 71, 72,
        36, 29, 13, 18, 27, 22, 1, 14, 17, 40, 3, 4, 6, 17, 1, 16, 5, 5, 18, 19, 4, 1, 25, 7, 24, 7, 9, 2, 3, 16, 6,
        11, 11, 15, 9, 9, 17, 4, 5, 6, 9, 1, 1 };
    bigram[2] = new float[] { 390, 123, 510, 245, 289, 90, 68, 65, 370, 32, 40, 86, 216, 180, 157, 167, 10, 160, 260,
        158, 105, 52, 40, 62, 26, 12, 37, 7, 81, 11, 41, 3, 8, 7, 26, 3, 5, 10, 8, 29, 38, 9, 4, 20, 12, 14, 6, 4, 3,
        5, 12, 2, 21, 9, 24, 16, 6, 6, 3, 4, 3, 8, 1, 1 };
    bigram[3] = new float[] { 424, 48, 160, 89, 248, 52, 42, 62, 260, 22, 56, 123, 168, 298, 128, 114, 8, 169, 158, 59,
        99, 56, 34, 12, 17, 18, 15, 3, 21, 4, 15, 3, 5, 6, 15, 2, 4, 5, 5, 17, 19, 1, 1, 5, 7, 8, 5, 3, 3, 6, 15, 3, 8,
        7, 14, 18, 8, 8, 8, 1, 2, 7, 1, 1 };
    bigram[4] = new float[] { 131, 240, 295, 417, 198, 154, 216, 207, 258, 78, 165, 391, 376, 347, 84, 285, 7, 515,
        423, 466, 116, 220, 94, 11, 43, 61, 7, 5, 15, 12, 10, 4, 5, 2, 7, 1, 3, 21, 3, 12, 15, 2, 1, 9, 7, 6, 2, 2, 1,
        3, 6, 1, 12, 8, 10, 8, 9, 11, 7, 5, 6, 5, 1, 1 };
    bigram[5] = new float[] { 181, 40, 77, 68, 113, 89, 33, 31, 133, 12, 29, 60, 54, 64, 77, 62, 8, 59, 93, 71, 46, 19,
        23, 9, 11, 12, 18, 4, 8, 5, 14, 2, 5, 4, 7, 1, 6, 4, 3, 7, 9, 7, 1, 9, 10, 9, 4, 2, 3, 3, 4, 2, 5, 1, 8, 9, 4,
        5, 3, 3, 3, 3, 1, 1 };
    bigram[6] = new float[] { 249, 33, 58, 54, 156, 26, 45, 14, 171, 5, 36, 36, 69, 334, 115, 68, 5, 93, 64, 44, 74,
        36, 25, 8, 9, 4, 9, 2, 33, 5, 21, 3, 5, 9, 17, 2, 9, 5, 5, 9, 20, 6, 1, 8, 7, 9, 3, 4, 5, 3, 7, 3, 17, 14, 11,
        12, 7, 6, 5, 2, 3, 1, 1, 1 };
    bigram[7] = new float[] { 157, 51, 260, 68, 69, 21, 50, 31, 62, 18, 36, 48, 39, 60, 69, 98, 5, 39, 201, 127, 33,
        30, 36, 24, 9, 14, 9, 3, 6, 8, 13, 1, 3, 5, 29, 2, 9, 5, 5, 9, 6, 5, 3, 3, 4, 4, 3, 1, 1, 1, 2, 1, 18, 17, 24,
        10, 15, 11, 14, 13, 12, 5, 1, 1 };
    bigram[8] = new float[] { 238, 180, 318, 324, 142, 208, 155, 183, 480, 46, 179, 445, 332, 333, 69, 247, 14, 494,
        415, 364, 103, 352, 91, 208, 17, 54, 4, 2, 12, 16, 13, 2, 3, 4, 6, 2, 3, 19, 5, 5, 11, 5, 1, 26, 9, 17, 7, 1,
        1, 1, 3, 2, 4, 3, 5, 8, 6, 5, 5, 6, 4, 4, 1, 1 };
    bigram[9] = new float[] { 72, 15, 23, 16, 38, 9, 11, 7, 54, 13, 12, 26, 23, 34, 30, 26, 3, 28, 27, 27, 23, 7, 4, 5,
        4, 4, 11, 1, 3, 2, 12, 1, 1, 1, 5, 1, 5, 2, 3, 4, 10, 1, 1, 5, 5, 6, 1, 1, 1, 1, 2, 2, 1, 1, 4, 4, 3, 2, 1, 3,
        2, 2, 1, 1 };
    bigram[10] = new float[] { 251, 38, 72, 47, 153, 40, 49, 45, 178, 32, 93, 60, 55, 88, 109, 73, 5, 86, 163, 59, 79,
        25, 17, 6, 15, 20, 13, 2, 28, 7, 11, 2, 4, 6, 12, 1, 6, 2, 3, 8, 6, 2, 1, 6, 3, 5, 6, 2, 1, 2, 1, 3, 49, 28,
        32, 24, 26, 31, 21, 17, 24, 24, 1, 1 };
    bigram[11] = new float[] { 564, 113, 221, 116, 405, 84, 90, 41, 277, 17, 74, 227, 108, 68, 246, 124, 24, 89, 145,
        67, 195, 38, 19, 76, 30, 19, 18, 5, 26, 11, 27, 3, 3, 2, 20, 1, 4, 4, 4, 19, 11, 4, 1, 7, 17, 15, 4, 1, 1, 3,
        6, 1, 3, 3, 4, 2, 5, 3, 5, 2, 3, 4, 1, 1 };
    bigram[12] = new float[] { 430, 58, 208, 86, 272, 62, 70, 52, 274, 33, 74, 85, 129, 59, 234, 109, 14, 232, 164, 88,
        176, 40, 22, 10, 22, 29, 26, 9, 27, 6, 48, 5, 3, 7, 20, 1, 9, 5, 3, 15, 12, 4, 1, 17, 10, 21, 7, 7, 3, 1, 12,
        2, 32, 18, 15, 14, 16, 17, 13, 9, 8, 4, 1, 1 };
    bigram[13] = new float[] { 1022, 50, 99, 90, 542, 39, 73, 39, 645, 16, 55, 42, 48, 125, 462, 70, 5, 111, 87, 78,
        281, 49, 26, 7, 24, 17, 25, 2, 23, 8, 16, 1, 3, 4, 17, 1, 6, 3, 5, 7, 14, 3, 1, 12, 10, 7, 9, 6, 2, 5, 6, 1,
        14, 22, 19, 13, 13, 22, 9, 11, 10, 6, 1, 1 };
    bigram[14] = new float[] { 73, 177, 419, 230, 78, 126, 137, 181, 209, 78, 223, 256, 260, 238, 142, 241, 6, 354,
        271, 330, 25, 81, 57, 13, 66, 47, 9, 5, 7, 11, 14, 1, 4, 1, 11, 1, 3, 24, 6, 13, 3, 7, 1, 11, 7, 9, 2, 2, 1, 1,
        4, 3, 2, 7, 14, 11, 8, 5, 8, 2, 6, 3, 1, 1 };
    bigram[15] = new float[] { 335, 75, 144, 100, 197, 83, 93, 57, 247, 37, 98, 81, 207, 83, 197, 165, 8, 105, 260, 97,
        135, 41, 25, 29, 18, 26, 21, 6, 12, 13, 34, 3, 7, 7, 56, 1, 8, 10, 7, 22, 18, 5, 2, 18, 16, 19, 9, 5, 3, 5, 7,
        1, 11, 8, 5, 7, 7, 7, 4, 1, 3, 4, 1, 1 };
    bigram[16] = new float[] { 45, 7, 13, 7, 15, 2, 3, 14, 20, 6, 4, 4, 6, 10, 9, 10, 4, 6, 25, 11, 3, 8, 4, 2, 1, 3,
        3, 3, 9, 2, 1, 1, 2, 1, 7, 2, 2, 1, 1, 3, 3, 1, 1, 2, 3, 4, 1, 1, 2, 1, 1, 1, 2, 2, 3, 2, 2, 2, 2, 1, 1, 1, 1,
        1 };
    bigram[17] = new float[] { 764, 146, 156, 135, 831, 101, 115, 79, 293, 15, 70, 39, 74, 61, 439, 239, 9, 126, 119,
        216, 238, 51, 29, 12, 21, 15, 10, 3, 5, 9, 19, 3, 4, 4, 9, 1, 4, 3, 3, 12, 13, 6, 1, 9, 4, 16, 6, 3, 1, 2, 6,
        4, 7, 4, 5, 5, 2, 6, 3, 3, 2, 2, 1, 1 };
    bigram[18] = new float[] { 617, 126, 184, 173, 582, 83, 95, 93, 549, 35, 119, 116, 182, 263, 386, 219, 22, 235,
        307, 192, 288, 80, 69, 9, 52, 37, 33, 8, 10, 20, 68, 7, 8, 6, 31, 2, 15, 13, 12, 48, 39, 11, 1, 32, 4, 22, 10,
        6, 2, 8, 17, 3, 13, 9, 10, 9, 6, 2, 7, 2, 5, 3, 1, 1 };
    bigram[19] = new float[] { 523, 58, 153, 60, 320, 67, 76, 91, 367, 17, 74, 128, 108, 315, 186, 121, 9, 264, 524,
        167, 161, 50, 36, 25, 20, 17, 24, 6, 7, 11, 32, 2, 10, 12, 18, 1, 6, 10, 9, 22, 29, 6, 2, 12, 8, 10, 8, 2, 3,
        4, 7, 2, 9, 9, 10, 10, 11, 5, 4, 4, 3, 5, 1, 1 };
    bigram[20] = new float[] { 149, 113, 87, 101, 99, 47, 106, 95, 51, 71, 121, 119, 137, 127, 126, 119, 56, 142, 199,
        190, 38, 23, 17, 8, 24, 24, 5, 1, 2, 4, 4, 1, 5, 3, 6, 1, 3, 11, 1, 8, 5, 3, 1, 1, 3, 3, 1, 1, 1, 2, 3, 1, 2,
        4, 7, 2, 4, 3, 1, 3, 2, 2, 1, 1 };
    bigram[21] = new float[] { 169, 42, 74, 58, 111, 17, 30, 29, 147, 18, 29, 90, 45, 75, 98, 58, 9, 58, 75, 176, 37,
        37, 12, 139, 8, 15, 8, 2, 7, 7, 26, 1, 2, 2, 14, 1, 7, 4, 5, 12, 8, 3, 1, 2, 4, 5, 3, 3, 2, 1, 2, 1, 10, 4, 5,
        2, 4, 3, 4, 1, 2, 3, 1, 1 };
    bigram[22] = new float[] { 82, 13, 40, 27, 61, 18, 11, 16, 31, 7, 24, 22, 45, 34, 61, 32, 3, 35, 71, 27, 18, 5, 34,
        2, 5, 8, 6, 3, 6, 10, 23, 2, 2, 7, 7, 1, 14, 4, 9, 13, 11, 2, 1, 5, 8, 17, 4, 1, 2, 2, 3, 4, 10, 4, 9, 9, 3, 4,
        4, 3, 3, 2, 1, 1 };
    bigram[23] = new float[] { 51, 7, 126, 61, 83, 16, 6, 7, 93, 2, 5, 157, 67, 12, 26, 8, 3, 12, 20, 20, 21, 5, 5,
        324, 4, 4, 3, 2, 1, 1, 22, 1, 3, 2, 3, 1, 2, 2, 2, 2, 3, 1, 1, 3, 1, 5, 1, 4, 1, 2, 3, 1, 3, 3, 4, 2, 5, 3, 1,
        3, 5, 2, 1, 1 };
    bigram[24] = new float[] { 147, 24, 30, 23, 40, 11, 15, 21, 23, 5, 29, 43, 24, 66, 30, 13, 5, 43, 54, 35, 13, 3, 4,
        9, 4, 5, 1, 2, 1, 2, 4, 1, 2, 1, 2, 2, 2, 1, 1, 6, 2, 1, 1, 1, 2, 5, 1, 1, 3, 2, 4, 1, 1, 1, 2, 4, 1, 2, 1, 1,
        1, 2, 1, 1 };
    bigram[25] = new float[] { 98, 10, 14, 21, 54, 3, 10, 9, 58, 5, 6, 17, 20, 121, 40, 26, 2, 20, 58, 29, 27, 9, 4, 2,
        10, 11, 10, 1, 1, 1, 1, 1, 1, 3, 4, 1, 3, 1, 1, 7, 3, 1, 1, 3, 2, 2, 4, 2, 2, 1, 2, 1, 2, 3, 4, 2, 1, 2, 1, 3,
        2, 1, 1, 1 };
    bigram[26] = new float[] { 401, 4478, 3673, 2325, 132, 1877, 2368, 3755, 161, 1771, 4787, 3299, 8092, 3606, 54,
        4511, 429, 2717, 4494, 3124, 49, 1887, 2016, 307, 426, 1173, 41174, 25593, 18714, 41688, 16107, 10508, 36164,
        37764, 41296, 18499, 48236, 66118, 53908, 72451, 6520, 31956, 12581, 86274, 43293, 81350, 15102, 26588, 18225,
        2576, 14698, 17047, 83, 45, 51, 46, 47, 35, 36, 30, 29, 28, 1, 1 };
    bigram[27] = new float[] { 1037, 6, 4, 8, 125, 2, 15, 7, 177, 4, 23, 4, 156, 4, 572, 4, 1, 6, 23, 13, 88, 4, 4, 7,
        8, 63, 19028, 1508, 71, 1446, 8478, 227, 1026, 367, 9319, 136, 596, 2577, 9167, 2547, 9273, 238, 47, 6838,
        2547, 1353, 7139, 140, 130, 87, 1192, 1079, 7, 10, 8, 3, 6, 2, 6, 2, 2, 1, 1, 1 };
    bigram[28] = new float[] { 595, 6, 4, 4, 226, 2, 2, 2, 74, 5, 2, 1, 293, 10, 223, 8, 2, 2, 1959, 30, 71, 5, 5, 5,
        9, 4, 21692, 165, 2353, 399, 15033, 36, 160, 262, 25648, 187, 916, 1654, 569, 12719, 8493, 416, 32, 5305,
        12985, 942, 5813, 518, 301, 374, 2533, 420, 38, 10, 10, 8, 6, 16, 6, 7, 8, 6, 1, 1 };
    bigram[29] = new float[] { 969, 9, 12, 60, 456, 6, 17, 3, 289, 6, 19, 5, 16, 127, 398, 13, 4, 11, 8, 6, 168, 9, 3,
        1, 8, 54, 41876, 610, 203, 8911, 28360, 389, 1585, 521, 24386, 697, 539, 8628, 995, 41978, 17803, 341, 296,
        13534, 1407, 728, 11172, 445, 349, 198, 4198, 1362, 12, 5, 12, 7, 5, 7, 11, 11, 10, 5, 1, 1 };
    bigram[30] = new float[] { 266, 4011, 1068, 3051, 180, 1319, 2450, 2564, 153, 863, 1653, 2336, 3463, 1980, 84,
        3187, 93, 3703, 3188, 2570, 112, 2546, 1274, 110, 240, 734, 7129, 22523, 14384, 51112, 16196, 10162, 33651,
        27432, 37634, 20060, 24384, 56885, 40457, 58830, 7341, 23717, 820, 76224, 39250, 78514, 10659, 29380, 9449,
        1702, 5639, 12750, 63, 27, 18, 14, 17, 47, 21, 15, 11, 19, 1, 1 };
    bigram[31] = new float[] { 493, 4, 6, 6, 147, 102, 5, 3, 42, 3, 7, 6, 15, 3, 215, 127, 1, 2, 33, 2, 38, 4, 2, 3, 5,
        1, 9309, 86, 22, 500, 6995, 4724, 322, 265, 7552, 153, 219, 1911, 767, 3961, 5136, 570, 5, 4236, 1861, 726,
        2774, 74, 66, 42, 1269, 63, 22, 7, 10, 4, 7, 8, 3, 8, 10, 8, 1, 1 };
    bigram[32] = new float[] { 609, 7, 5, 3, 340, 1, 3, 5, 241, 2, 11, 4, 33, 253, 114, 4, 1, 8, 18, 3, 133, 7, 3, 3,
        4, 44, 25854, 236, 13, 972, 20833, 597, 3731, 315, 24295, 121, 286, 3245, 561, 56100, 13489, 497, 3, 9825,
        1957, 1601, 8067, 178, 172, 38, 1810, 805, 24, 6, 11, 8, 4, 6, 3, 3, 4, 2, 1, 1 };
    bigram[33] = new float[] { 216, 235, 2510, 304, 106, 7, 179, 3, 65, 35, 471, 35, 113, 39, 98, 516, 3, 277, 1731,
        1190, 61, 17, 391, 104, 1, 103, 14960, 1071, 39033, 5104, 5894, 158, 3826, 919, 6858, 104, 2704, 2255, 747,
        3517, 4493, 2531, 12, 2727, 15432, 9354, 3383, 235, 1746, 422, 353, 1805, 38, 34, 24, 28, 21, 18, 15, 22, 27,
        30, 1, 1 };
    bigram[34] = new float[] { 422, 1955, 845, 2638, 700, 1559, 1083, 1452, 38, 285, 1735, 2364, 3098, 1485, 72, 1769,
        170, 1318, 2613, 1562, 87, 2255, 1280, 223, 54, 484, 21748, 17028, 21723, 39883, 22352, 14818, 23482, 20967,
        11701, 7972, 25315, 69444, 36980, 65869, 5339, 17086, 2657, 74184, 50443, 72750, 11162, 21374, 5550, 2985,
        2215, 14377, 18, 5, 6, 3, 3, 7, 7, 1, 6, 2, 1, 1 };
    bigram[35] = new float[] { 167, 66, 6, 134, 37, 54, 233, 48, 17, 5, 55, 82, 60, 109, 34, 33, 1, 9, 90, 55, 69, 40,
        2, 1, 3, 17, 11629, 756, 822, 1350, 7100, 394, 2228, 529, 12208, 77, 840, 5003, 687, 6612, 9232, 389, 47, 2315,
        2535, 2026, 3467, 690, 19, 25, 672, 298, 14, 3, 3, 6, 4, 4, 3, 3, 1, 4, 1, 1 };
    bigram[36] = new float[] { 735, 10, 3, 5, 390, 3, 3, 9, 244, 4, 1, 8, 55, 27, 238, 11, 1, 4, 953, 8, 168, 3, 1, 2,
        3, 4, 36629, 441, 4983, 1503, 25086, 307, 2262, 1466, 36357, 1062, 5832, 4503, 913, 10218, 12110, 486, 6, 9821,
        23688, 2391, 10599, 412, 257, 91, 1828, 1721, 98, 20, 38, 21, 31, 30, 30, 23, 28, 19, 1, 1 };
    bigram[37] = new float[] { 2774, 826, 628, 21, 1067, 762, 574, 72, 651, 4, 816, 364, 73, 4, 590, 925, 3, 1, 561,
        54, 327, 190, 21, 6, 17, 47, 75415, 7168, 2274, 3261, 49073, 3483, 5418, 3274, 42213, 333, 7378, 29069, 2071,
        3058, 32875, 8876, 250, 9260, 7153, 5335, 23137, 2061, 864, 92, 2571, 1121, 8, 7, 2, 1, 2, 3, 3, 2, 1, 2, 1, 1 };
    bigram[38] = new float[] { 1206, 3, 13, 22, 509, 3, 16, 49, 580, 8, 34, 4, 11, 4, 210, 5, 1, 2, 258, 5, 324, 6, 2,
        7, 63, 39, 44186, 175, 195, 1394, 29638, 133, 1091, 1950, 32249, 362, 845, 4506, 8242, 1396, 27069, 260, 54,
        11653, 5931, 1743, 21774, 115, 597, 97, 2921, 1654, 167, 31, 24, 25, 25, 47, 27, 21, 23, 19, 1, 1 };
    bigram[39] = new float[] { 2985, 11, 31, 48, 1278, 7, 60, 40, 3334, 5, 208, 4, 59, 4, 433, 18, 2, 4, 190, 11, 1037,
        8, 5, 2, 38, 47, 140881, 744, 377, 3805, 121901, 743, 4317, 2729, 110371, 2739, 2052, 3929, 2558, 25648, 69682,
        728, 76, 17525, 3366, 4525, 36940, 2336, 1452, 130, 5536, 2894, 19, 5, 16, 6, 3, 6, 3, 4, 2, 2, 1, 1 };
    bigram[40] = new float[] { 72, 2667, 3680, 1806, 33, 1431, 1611, 1972, 138, 958, 4103, 1412, 3123, 1824, 99, 3353,
        136, 2232, 2480, 1804, 22, 1219, 573, 64, 268, 398, 3654, 12626, 17692, 24754, 5013, 9877, 13496, 17074, 28971,
        7436, 35492, 27506, 19253, 26506, 13041, 25683, 1031, 43405, 19889, 39797, 3054, 13011, 2567, 1103, 5852, 5840,
        8, 7, 10, 4, 4, 4, 4, 7, 4, 3, 1, 1 };
    bigram[41] = new float[] { 810, 5, 7, 2, 251, 5, 4, 2, 128, 1, 8, 5, 75, 3, 596, 3, 1, 32, 1518, 4, 200, 6, 6, 14,
        8, 2, 18632, 84, 56, 778, 9829, 83, 1371, 477, 10307, 159, 430, 1783, 11318, 1161, 13775, 6596, 5, 6807, 13308,
        848, 8296, 341, 169, 962, 1244, 683, 30, 3, 12, 5, 9, 12, 3, 5, 9, 5, 1, 1 };
    bigram[42] = new float[] { 134, 3, 1, 2, 112, 5, 2, 2, 19, 1, 1, 1, 2, 3, 80, 3, 2, 1, 37, 1, 6, 1, 1, 1, 1, 1,
        6714, 37, 173, 65, 8494, 25, 16, 227, 1558, 9, 14, 197, 168, 640, 7164, 8, 2628, 536, 732, 71, 590, 25, 21, 18,
        54, 24, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1 };
    bigram[43] = new float[] { 2787, 2326, 848, 843, 1269, 1611, 1994, 172, 461, 2, 1605, 3, 66, 7, 1114, 3764, 14, 85,
        182, 2332, 467, 232, 68, 10, 14, 42, 109220, 8938, 3642, 8530, 131099, 4884, 10693, 3952, 25494, 256, 8384,
        577, 800, 1205, 61442, 24452, 121, 12342, 1659, 29660, 30835, 2467, 1044, 44, 3103, 590, 8, 5, 13, 18, 9, 4, 6,
        3, 7, 7, 1, 1 };
    bigram[44] = new float[] { 1141, 19, 80, 34, 1159, 20, 17, 10, 1038, 18, 34, 8, 90, 16, 636, 178, 4, 19, 14, 207,
        328, 48, 31, 10, 58, 22, 58475, 2124, 1079, 5713, 63424, 1311, 6331, 1197, 70783, 2008, 8367, 7031, 3876,
        26334, 32246, 3150, 117, 24516, 25737, 17027, 33999, 1448, 996, 161, 5723, 433, 53, 22, 18, 13, 15, 8, 6, 10,
        8, 9, 1, 1 };
    bigram[45] = new float[] { 1027, 7, 17, 6, 377, 9, 5, 8, 360, 5, 22, 12, 63, 27, 322, 65, 4, 10, 3583, 7, 276, 5,
        3, 9, 14, 3, 75795, 842, 5068, 1624, 45494, 3183, 3706, 6487, 55061, 865, 11101, 9802, 1831, 52972, 20047,
        4072, 116, 29523, 65864, 14710, 30741, 498, 275, 1111, 2725, 1858, 36, 6, 12, 8, 21, 18, 19, 13, 15, 20, 2, 50 };
    bigram[46] = new float[] { 1472, 1948, 649, 1107, 596, 689, 1221, 946, 95, 1129, 1800, 1219, 1874, 730, 209, 1064,
        798, 1062, 2328, 1615, 82, 171, 134, 129, 232, 420, 17427, 10001, 5943, 13136, 6949, 4258, 13758, 9592, 8797,
        7544, 21206, 20112, 12559, 14042, 13057, 10325, 7791, 21173, 22230, 33067, 6621, 2799, 436, 772, 1475, 3853, 2,
        2, 4, 1, 4, 2, 1, 3, 3, 2, 1, 1 };
    bigram[47] = new float[] { 451, 3, 25, 61, 365, 3, 32, 73, 129, 2, 143, 11, 18, 5, 172, 15, 10, 9, 385, 69, 39, 6,
        1, 11, 18, 80, 18590, 168, 68, 1715, 11611, 135, 546, 938, 13221, 244, 1548, 2541, 316, 3921, 16452, 228, 34,
        4722, 3204, 2807, 2561, 265, 28, 19, 547, 1066, 19, 15, 10, 10, 11, 11, 13, 13, 10, 14, 1, 1 };
    bigram[48] = new float[] { 140, 46, 22, 57, 58, 21, 259, 21, 75, 7, 96, 21, 155, 6, 48, 26, 11, 28, 226, 114, 27,
        2, 3, 2, 1, 157, 8213, 354, 100, 1261, 4040, 239, 1233, 1558, 3086, 71, 962, 917, 581, 1013, 6017, 192, 8,
        2021, 1294, 1420, 1960, 7, 270, 73, 960, 765, 3, 1, 4, 1, 3, 4, 1, 1, 1, 1, 1, 1 };
    bigram[49] = new float[] { 58, 5, 1, 2, 545, 2, 1, 1, 29, 1, 2, 1, 2, 12, 63, 2, 2, 4, 2, 47, 8, 3, 1, 2, 3, 1,
        2323, 23, 11, 30, 3874, 12, 38, 18, 1751, 6, 155, 66, 33, 262, 968, 41, 3, 296, 22, 763, 994, 18, 7, 46, 62, 2,
        39, 7, 20, 13, 33, 15, 12, 7, 7, 4, 1, 1 };
    bigram[50] = new float[] { 179, 219, 385, 195, 73, 87, 153, 260, 33, 22, 135, 249, 259, 226, 37, 113, 22, 186, 493,
        258, 36, 109, 190, 5, 3, 55, 14440, 2149, 1584, 2622, 5632, 999, 2138, 2021, 5956, 192, 2144, 5208, 1150, 9322,
        2290, 671, 140, 5992, 3758, 4993, 1173, 1464, 3465, 144, 118, 1589, 4, 1, 1, 4, 6, 3, 1, 1, 2, 1, 1, 1 };
    bigram[51] = new float[] { 339, 7, 103, 80, 99, 1, 2, 20, 286, 2, 2, 1, 20, 11, 90, 5, 3, 27, 257, 15, 124, 36, 6,
        2, 4, 2, 10511, 106, 2314, 1577, 9661, 109, 213, 127, 14104, 147, 287, 632, 417, 3346, 5225, 64, 1, 3650, 3148,
        7078, 4239, 374, 72, 11, 387, 1060, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 1, 1 };
    bigram[52] = new float[] { 9, 8, 12, 7, 13, 5, 4, 20, 1, 2, 6, 5, 5, 7, 2, 9, 1, 5, 18, 7, 1, 3, 8, 4, 1, 2, 53, 7,
        7, 17, 109, 6, 11, 45, 20, 1, 17, 35, 18, 48, 16, 14, 2, 31, 74, 35, 6, 3, 4, 6, 20, 2, 1714, 924, 1042, 518,
        444, 591, 415, 333, 458, 295, 27, 193 };
    bigram[53] = new float[] { 39, 19, 37, 20, 18, 17, 11, 20, 6, 5, 21, 7, 54, 17, 17, 49, 6, 67, 35, 23, 17, 14, 5,
        15, 5, 6, 39, 11, 14, 20, 44, 6, 51, 30, 40, 4, 19, 11, 15, 69, 35, 21, 3, 20, 20, 18, 36, 8, 5, 33, 6, 5, 536,
        615, 483, 302, 268, 242, 203, 205, 253, 219, 23, 460 };
    bigram[54] = new float[] { 28, 26, 21, 14, 11, 12, 11, 26, 9, 4, 15, 18, 46, 15, 26, 36, 2, 41, 27, 19, 9, 19, 10,
        14, 5, 3, 35, 9, 10, 24, 38, 5, 38, 41, 38, 2, 9, 22, 35, 49, 33, 22, 3, 12, 32, 14, 35, 7, 3, 29, 9, 2, 861,
        631, 466, 307, 263, 240, 217, 198, 292, 230, 22, 314 };
    bigram[55] = new float[] { 26, 17, 26, 13, 13, 8, 7, 20, 3, 3, 8, 6, 36, 15, 23, 35, 9, 30, 18, 17, 4, 11, 5, 6, 2,
        3, 13, 4, 5, 9, 12, 5, 25, 52, 33, 1, 12, 10, 26, 31, 30, 10, 1, 4, 5, 11, 29, 5, 4, 21, 5, 2, 308, 501, 416,
        305, 250, 222, 214, 191, 250, 211, 21, 83 };
    bigram[56] = new float[] { 25, 10, 14, 10, 11, 11, 11, 16, 4, 4, 6, 12, 23, 7, 16, 28, 2, 21, 14, 12, 5, 6, 3, 5,
        3, 2, 22, 3, 4, 11, 27, 2, 44, 43, 48, 2, 4, 3, 6, 53, 36, 7, 2, 4, 5, 2, 32, 5, 4, 23, 5, 2, 297, 481, 476,
        283, 257, 229, 230, 183, 215, 221, 7, 94 };
    bigram[57] = new float[] { 9, 10, 11, 7, 13, 5, 4, 13, 2, 1, 3, 7, 17, 6, 5, 14, 3, 23, 9, 17, 4, 3, 1, 6, 1, 5, 5,
        2, 3, 4, 8, 4, 2, 29, 8, 1, 2, 2, 6, 5, 6, 7, 1, 2, 5, 7, 5, 3, 1, 14, 4, 3, 284, 552, 550, 290, 293, 278, 222,
        221, 211, 261, 16, 81 };
    bigram[58] = new float[] { 11, 7, 15, 7, 10, 7, 6, 7, 3, 2, 3, 6, 14, 7, 3, 10, 3, 17, 5, 9, 1, 11, 2, 8, 1, 1, 4,
        3, 6, 6, 1, 3, 7, 3, 15, 1, 3, 2, 8, 7, 6, 4, 1, 4, 3, 7, 9, 5, 1, 13, 2, 3, 243, 494, 364, 285, 220, 242, 210,
        212, 196, 215, 34, 70 };
    bigram[59] = new float[] { 8, 11, 5, 3, 9, 2, 7, 4, 2, 4, 4, 5, 12, 6, 4, 14, 2, 14, 2, 2, 2, 7, 2, 4, 1, 2, 10, 1,
        2, 10, 9, 1, 3, 4, 7, 1, 2, 1, 3, 4, 4, 3, 1, 8, 5, 4, 1, 4, 1, 10, 1, 1, 260, 434, 365, 229, 223, 211, 199,
        211, 182, 254, 4, 63 };
    bigram[60] = new float[] { 7, 2, 5, 8, 4, 7, 5, 5, 2, 3, 3, 4, 15, 6, 6, 10, 2, 11, 5, 3, 2, 7, 4, 5, 1, 3, 9, 2,
        2, 5, 6, 6, 2, 4, 3, 2, 3, 6, 4, 5, 2, 1, 1, 5, 6, 2, 2, 1, 1, 9, 1, 2, 290, 514, 623, 248, 232, 191, 201, 197,
        225, 309, 2, 59 };
    bigram[61] = new float[] { 7, 8, 7, 6, 3, 7, 3, 3, 2, 1, 4, 4, 13, 8, 7, 11, 1, 15, 6, 7, 4, 8, 2, 5, 2, 2, 3, 2,
        2, 3, 3, 4, 1, 1, 6, 2, 4, 8, 1, 3, 2, 6, 1, 1, 3, 4, 1, 1, 1, 4, 1, 3, 272, 923, 282, 250, 197, 200, 180, 172,
        192, 450, 3, 106 };
    bigram[62] = new float[] { 4, 3, 12, 3, 2, 2, 3, 4, 10, 1, 4, 5, 2, 3, 1, 2, 1, 1, 3, 5, 50, 3, 2, 1, 1, 1, 7, 1,
        1, 1, 5, 1, 4, 1, 3, 1, 2, 5, 2, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 1, 2, 1, 16, 11, 11, 14, 5, 8, 9, 3, 10, 5, 2, 2 };
    bigram[63] = new float[] { 45, 19, 67, 26, 23, 5, 18, 8, 35, 10, 13, 16, 12, 21, 33, 38, 2, 16, 40, 17, 10, 25, 12,
        6, 1, 6, 139, 13, 26, 64, 201, 13, 101, 55, 62, 7, 44, 69, 60, 157, 86, 19, 3, 159, 170, 147, 23, 12, 9, 6, 57,
        6, 178, 217, 170, 166, 158, 136, 122, 120, 117, 119, 1, 2 };
    log2Normalize(bigram);

    log2ProbPad = unigram[bigram.length - 2]; // make it the same as the '+', i.e. rare
  }

  @Override
  protected float log2ProbPad() {
    return log2ProbPad;
  }

  @Override
  protected float log2ProbStart(byte current) {
    int index = Base64Characters.index(current);
    if (index < 0) {
      return Float.NEGATIVE_INFINITY;
    }
    return unigram[index];
  }

  @Override
  protected float log2ProbEnd(byte previous) {
    int index = Base64Characters.index(previous);
    if (index < 0) {
      return Float.NEGATIVE_INFINITY;
    }
    return unigram[index];
  }

  @Override
  protected float log2ProbBigram(byte current, byte previous) {
    int c = Base64Characters.index(current);
    int p = Base64Characters.index(previous);
    if (c < 0 || p < 0) {
      return Float.NEGATIVE_INFINITY;
    }
    return bigram[c][p];
  }
}
